---
layout: post
title: Back to blogging ... Selenium and modal dialogs
date: '2009-05-05T06:32:00.004-04:00'
author: Dawn
tags: 
modified_time: '2009-05-05T07:31:07.712-04:00'
thumbnail: http://1.bp.blogspot.com/_uSs0FPBdbmE/SgAjLM0-ipI/AAAAAAAAAAM/3q3SJqz2gKQ/s72-c/code.gif
blogger_id: tag:blogger.com,1999:blog-6005334108330583722.post-892929118788486331
blogger_orig_url: http://confessionsofanagiletester.blogspot.com/2009/05/back-to-blogging-selenium-and-modal.html
---

It has been *way* too long since my last blog post, but another post is better late than never, right?<br /><br />Most recently, I have struggled through automating a heavily AJAX-ey and  fairly complex web interface using Selenium.<br /><br />I have a setup that looks like this:<br />Visual Studio C# Express<br />NUnit<br />Selenium RC<br />IE Developer Toolbar, for identifying objects on the page<br />(and now AutoIT)<br />The occasional use of the Selenium IDE for speed and efficiency's sake.<br /><br />I was having this particularly stubborn problem with a little dialog that popped up to confirm completion of some action, such as "User profile saved successfully".  To this day, I am not 100% certain that I can identify what to call this guy: A pop-up? Alert? Confirmation? IE modal dialog?<br /><br />Selenium IDE did not record or recognize in any way that this dialog exists.  Further, my IE developer toolbar does not recognize this dialog when it's up, either.  This all makes identifying it a bit difficult.<br /><br />In my Selenium script, I tried identifying it as a pop-up, I tried identifying it as an alert, confirmation, and prompt, and none of them worked.  My research indicated that this might be an "IE modal dialog" -- which is not supported by Selenium.<br /><br />As I reached out to the agile-testing Yahoo group for help, I asked the developers how this dialog was being created.  They showed me some code that simply called a javascript alert.  I am still a little confused about that part, since Selenium RC should capture javascript alerts and close them. (Eventually I figured out that if the alert was called without a page redirect, Selenium behaved as expected, but if it was called as part of a page redirect function, Selenium failed to get it.)<br /><br />Here is what the code that calls this dialog looks like:<br /><br /><a onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}" href="http://1.bp.blogspot.com/_uSs0FPBdbmE/SgAjLM0-ipI/AAAAAAAAAAM/3q3SJqz2gKQ/s1600-h/code.gif"><img style="cursor: pointer; width: 320px; height: 134px;" src="http://1.bp.blogspot.com/_uSs0FPBdbmE/SgAjLM0-ipI/AAAAAAAAAAM/3q3SJqz2gKQ/s320/code.gif" alt="" id="BLOGGER_PHOTO_ID_5332300634135628434" border="0" /></a><br /><br />The only difference between that and a similar dialog that Selenium correctly handles are those couple of lines that do the redirect ("<span style="color: rgb(161, 31, 18);font-size:85%;" >parent.<wbr>SetIframeMainModule</span>").  I am still unclear about why that throws a wrench into my Selenium script, but the bottom line was that my Selenium script was not running!<br /><br /><a href="http://chrismcmahonsblog.blogspot.com/">Chris McMahon</a> responded to my thread on the agile testing list that he had successfully used AutoIT to "hit it with a hammer".  After a little bit of searching online, I found a blog post where someone else had used this tool -- in this case, the poster created an executable that looked for windows with certain visible text, and just closes them.  This script runs separately from the Selenium test, just constantly polling the windows.  It's an ugly hack, but when I tried it, it worked and allowed my Selenium tests to run.<br /><br />To give proper credit, here is a link to the blog that posted this particular solution:<br /><h3 id="comments"><a href="http://www.eviltester.com/index.php/2009/01/22/get-rid-of-those-pesky-ie-dialogs-with-autoit/">Get rid of those pesky IE dialogs with AutoIt</a></h3>I would still love to hear about more graceful solutions ... I understand that Watir has found a way to handle these types of issues, and would love to see Selenium also be able to handle them.  Please comment if you have solved a similar problem in a different way!